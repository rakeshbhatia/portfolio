<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Project - Data Scraping for Stock Market Analysis</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="css/clean-blog.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    <link rel="stylesheet" href="highlight/styles/default.css">
    <script src="highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>-->

    <link href="css/prism.css" rel="stylesheet" />
    <link href="css/syntax.css" rel="stylesheet" />

    <!--<link rel="stylesheet" href="css/pygments14.css" type="text/css" />-->
    <!--<link rel="stylesheet" href="css/pygments.css" type="text/css" />-->
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <!-- <a class="navbar-brand" href="index.html">Start Bootstrap</a> -->
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <!--<li>
                        <a href="project1.html">Project 1</a>
                    </li>-->
                    <li>
                        <a href="contact.html">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/home-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="page-heading">
                        <h1>Python Blog</h1>
                        <hr class="small">
                        <span class="subheading">Javascript Web Scraping with PhantomJS and Selenium</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>In my previous post, I described how to create data structures for scraping stock market data from the
                  web, using Barron's as an example. Since the data we wanted to scrape from Barron's website was fully
                  rendered in HTML, we could simply use BeautifulSoup on its own to extract the required content. However,
                  BeautifulSoup alone will not work if the content is embedded in javascript. For this we need to use
                  PhantomJS and Selenium.</p>
                <p>My primary motivation for this tutorial is that it took me quite a bit of time to figure out how to do
                  this (seemingly) simple task: scraping javascript content using Python. The documentation for Selenium
                  and PhantomJS seemed a bit non-intuitive and difficult to grasp at first. Once I was able to figure out
                  how to do this task, I envisioned creating a sort of step-by-step "cheat sheet" that would enable others
                  to pick this up relatively quickly, without having to bury themselves in a web of countless Google searches
                  like I did.</p>
                <p>For this small project, it is advisable to create a virtual environment so that we can keep Selenium and
                  PhantomJS packaged locally with this project. The steps are shown below:</p>
                <pre><code class="language-python"></code></pre>

                <p>Now, let's install Selenium and PhantomJS using Brew:</p>

                <pre><code class="language-python"></code></pre>

                <p>Awesome. Now that we have our required utilities set up, we need to inspect the HTML source code for the
                javascript-rendered site that we want to scrape. If you just try to view the source, you will only see the
                javascript sections added under the <code>script</code> tag. We need to inspect the source in order to see
                the javascript executed and loaded as HTML. Then we must navigate through the web of nested HTML tags in order
                to find the content we are looking for. The resulting HTML after javascript content is loaded is usually quite
                complex and intricate, much more so than a bare-bones HTML webpage (this makes intuitive sense, since javascript
                handles more complex tasks than those which can be done by HTML alone).</p>

                <img src="img/yahoo-finance-screenshot-1.jpg" alt="yahoo inspect screenshot 1" style='height: 100%; width: 100%; object-fit: contain'/>

                <p>Running your cursor over different sections of the webpage will highlight the sections of code that correspond
                  to it. Let's try to navigate our way to where the value for "Beta" is contained. Don't worry too much about the
                  strange tag id's; we're only concerned with finding the specific tags that we need. For now, we'll focus on just
                  grabbing this one piece of information - the stock's beta value - to demonstrate the power of Selenium and PhantomJS.
                  Afterwards, you can extrapolate it to whatever content you want to scrape. In order to obtain the element that we want,
                  the easiest way is to use the XPath for that element. Right-click the line of code corresponding to your desired element,
                  select "Copy", and then select "Copy XPath". This will copy the XPath variable to the clipboard, which we can then use
                  in our Python script. I would suggest pasting the XPath in a safe place, perhaps a simple text file, so that you can
                  retrieve it later.</p>

                <img src="img/yahoo-finance-screenshot-2.jpg" alt="yahoo inspect screenshot 2" style='height: 100%; width: 100%; object-fit: contain'/>

                <p>We can keep our <code>Index</code> class the same as from my previous post, which describes web scraping pure HTML content
                  from Barron's stock website. In case you didn't see it, <a href="#">here</a> is the link to this post. Since we are changing
                  the website which we use to query stock quotes from Barron's to Yahoo! Finance, we only need to worry about modifying the
                  <code>query_stock_symbol()</code> method for our <code>Stock</code> class. </p>

                <pre><code class="language-python">

                </code></pre>




                <p>Be sure to check out the <a href="https://github.com/rakeshbhatia/stock-market-data" style="color:teal">Github</a> repository
                if you want to download the source code for yourself. Thanks for reading!</p>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Rakesh Bhatia 2017</p>
                </div>
            </div>

            <div class="col-lg-8">
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>

    <script src="js/prism.js"></script>
</body>

</html>
